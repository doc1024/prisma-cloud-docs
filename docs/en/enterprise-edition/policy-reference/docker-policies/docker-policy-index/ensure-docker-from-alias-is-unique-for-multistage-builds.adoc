== Docker From alias is not unique for multistage builds


=== Policy Details
[width=45%]
[cols="1,1"]
|=== 
|Prisma Cloud Policy ID 
| eb4a901e-a5cc-4490-915a-8b9287425572

|Checkov ID 
| https://github.com/bridgecrewio/checkov/tree/master/checkov/dockerfile/checks/AliasIsUnique.py[CKV_DOCKER_11]

|Severity
|LOW

|Subtype
|Build

|Frameworks
|Docker

|=== 



=== Description

In Docker multistage builds, using unique aliases for each stage ensures clarity and prevents conflicts between stages. Aliases help to identify stages in the build process, making Dockerfiles more readable and maintainable. Unique aliases also avoid any unintentional overwriting of stages and ensure that each stage is referenced correctly.

This policy checks that each `FROM` instruction in a Dockerfile uses a unique alias when building multistage images.

=== Fix - Buildtime


*Docker* 

To mitigate this issue, ensure that each `FROM` instruction in your multistage Dockerfile uses a unique alias.

Example:

[source,dockerfile]
----
FROM node:14 as builder
...
- FROM node:14 as builder # Duplicate alias
+ FROM node:14 as builder_2 # Unique alias
...
----
